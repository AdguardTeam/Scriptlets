{"version":3,"file":"linesBeforeBlock.cjs","names":["_iterateJsdoc","_interopRequireDefault","require","e","__esModule","default","_default","exports","iterateJsdoc","context","jsdocNode","sourceCode","report","utils","_tokenBefore$loc","_jsdocNode$loc","lines","ignoreSameLine","excludedTags","options","hasATag","tokensBefore","getTokensBefore","includeComments","tokenBefore","slice","loc","end","line","start","_jsdocNode$loc2","_tokenBefore$loc2","startLine","sameLine","fix","fixer","indent","_jsdocNode$loc3","_tokenBefore$loc3","_jsdocNode$value$matc","spaceDiff","column","value","match","tokenPrior","startColumn","_tokenPrior","_tokenPrior$loc","pop","repeat","insertTextAfter","iterateAllJsdocs","meta","fixable","docs","description","url","schema","additionalProperties","properties","type","items","module"],"sources":["../../src/rules/linesBeforeBlock.js"],"sourcesContent":["import iterateJsdoc from '../iterateJsdoc.js';\n\nexport default iterateJsdoc(({\n  context,\n  jsdocNode,\n  sourceCode,\n  report,\n  utils,\n}) => {\n  const {\n    lines = 1,\n    ignoreSameLine = true,\n    excludedTags = ['type']\n  } = context.options[0] || {};\n\n  if (utils.hasATag(excludedTags)) {\n    return;\n  }\n\n  const tokensBefore = sourceCode.getTokensBefore(jsdocNode, {includeComments: true});\n  const tokenBefore = tokensBefore.slice(-1)[0];\n  if (!tokenBefore) {\n    return;\n  }\n\n  if (tokenBefore.loc?.end?.line + lines >=\n    /** @type {number} */\n      (jsdocNode.loc?.start?.line)\n    ) {\n    const startLine = jsdocNode.loc?.start?.line;\n    const sameLine = tokenBefore.loc?.end?.line === startLine;\n\n    if (sameLine && ignoreSameLine) {\n      return;\n    }\n\n    /** @type {import('eslint').Rule.ReportFixer} */\n    const fix = (fixer) => {\n      let indent = '';\n      if (sameLine) {\n        const spaceDiff = /** @type {number} */ (jsdocNode.loc?.start?.column) -\n          /** @type {number} */ (tokenBefore.loc?.end?.column);\n        // @ts-expect-error Should be a comment\n        indent = /** @type {import('estree').Comment} */ (\n          jsdocNode\n        ).value.match(/^\\*\\n([ \\t]*) \\*/)?.[1]?.slice(spaceDiff);\n        if (!indent) {\n          /** @type {import('eslint').AST.Token|import('estree').Comment|undefined} */\n          let tokenPrior = tokenBefore;\n          let startColumn;\n          while (tokenPrior && tokenPrior?.loc?.start?.line === startLine) {\n            startColumn = tokenPrior.loc?.start?.column;\n            tokenPrior = tokensBefore.pop();\n          }\n          indent = ' '.repeat(\n            /* c8 ignore next */\n            /** @type {number} */ (startColumn ? startColumn - 1 : 0)\n          );\n        }\n      }\n\n      return fixer.insertTextAfter(\n        /** @type {import('eslint').AST.Token} */\n        (tokenBefore),\n        '\\n'.repeat(lines) +\n        (sameLine ? '\\n' + indent : '')\n      );\n    };\n    report(`Required ${lines} line(s) before JSDoc block`, fix);\n  }\n}, {\n  iterateAllJsdocs: true,\n  meta: {\n    fixable: 'code',\n    docs: {\n      description: 'Enforces minimum number of newlines before JSDoc comment blocks',\n      url: 'https://github.com/gajus/eslint-plugin-jsdoc/blob/main/docs/rules/lines-before-block.md#repos-sticky-header',\n    },\n    schema: [\n      {\n        additionalProperties: false,\n        properties: {\n          excludedTags: {\n            type: 'array',\n            items: {\n              type: 'string'\n            }\n          },\n          ignoreSameLine: {\n            type: 'boolean',\n          },\n          lines: {\n            type: 'integer'\n          }\n        },\n        type: 'object',\n      },\n    ],\n    type: 'suggestion',\n  },\n});\n"],"mappings":";;;;;;AAAA,IAAAA,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA8C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAF,OAAA,GAE/B,IAAAG,qBAAY,EAAC,CAAC;EAC3BC,OAAO;EACPC,SAAS;EACTC,UAAU;EACVC,MAAM;EACNC;AACF,CAAC,KAAK;EAAA,IAAAC,gBAAA,EAAAC,cAAA;EACJ,MAAM;IACJC,KAAK,GAAG,CAAC;IACTC,cAAc,GAAG,IAAI;IACrBC,YAAY,GAAG,CAAC,MAAM;EACxB,CAAC,GAAGT,OAAO,CAACU,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;EAE5B,IAAIN,KAAK,CAACO,OAAO,CAACF,YAAY,CAAC,EAAE;IAC/B;EACF;EAEA,MAAMG,YAAY,GAAGV,UAAU,CAACW,eAAe,CAACZ,SAAS,EAAE;IAACa,eAAe,EAAE;EAAI,CAAC,CAAC;EACnF,MAAMC,WAAW,GAAGH,YAAY,CAACI,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC7C,IAAI,CAACD,WAAW,EAAE;IAChB;EACF;EAEA,IAAI,EAAAV,gBAAA,GAAAU,WAAW,CAACE,GAAG,cAAAZ,gBAAA,gBAAAA,gBAAA,GAAfA,gBAAA,CAAiBa,GAAG,cAAAb,gBAAA,uBAApBA,gBAAA,CAAsBc,IAAI,IAAGZ,KAAK,MACpC,sBAAAD,cAAA,GACGL,SAAS,CAACgB,GAAG,cAAAX,cAAA,gBAAAA,cAAA,GAAbA,cAAA,CAAec,KAAK,cAAAd,cAAA,uBAApBA,cAAA,CAAsBa,IAAI,CAAC,EAC5B;IAAA,IAAAE,eAAA,EAAAC,iBAAA;IACF,MAAMC,SAAS,IAAAF,eAAA,GAAGpB,SAAS,CAACgB,GAAG,cAAAI,eAAA,gBAAAA,eAAA,GAAbA,eAAA,CAAeD,KAAK,cAAAC,eAAA,uBAApBA,eAAA,CAAsBF,IAAI;IAC5C,MAAMK,QAAQ,GAAG,EAAAF,iBAAA,GAAAP,WAAW,CAACE,GAAG,cAAAK,iBAAA,gBAAAA,iBAAA,GAAfA,iBAAA,CAAiBJ,GAAG,cAAAI,iBAAA,uBAApBA,iBAAA,CAAsBH,IAAI,MAAKI,SAAS;IAEzD,IAAIC,QAAQ,IAAIhB,cAAc,EAAE;MAC9B;IACF;;IAEA;IACA,MAAMiB,GAAG,GAAIC,KAAK,IAAK;MACrB,IAAIC,MAAM,GAAG,EAAE;MACf,IAAIH,QAAQ,EAAE;QAAA,IAAAI,eAAA,EAAAC,iBAAA,EAAAC,qBAAA;QACZ,MAAMC,SAAS,GAAG,qBAAsB,EAAAH,eAAA,GAAC3B,SAAS,CAACgB,GAAG,cAAAW,eAAA,gBAAAA,eAAA,GAAbA,eAAA,CAAeR,KAAK,cAAAQ,eAAA,uBAApBA,eAAA,CAAsBI,MAAM,MACnE,sBAAAH,iBAAA,GAAuBd,WAAW,CAACE,GAAG,cAAAY,iBAAA,gBAAAA,iBAAA,GAAfA,iBAAA,CAAiBX,GAAG,cAAAW,iBAAA,uBAApBA,iBAAA,CAAsBG,MAAM,CAAC;QACtD;QACAL,MAAM,GAAG,wCAAAG,qBAAA,GACP7B,SAAS,CACTgC,KAAK,CAACC,KAAK,CAAC,kBAAkB,CAAC,cAAAJ,qBAAA,gBAAAA,qBAAA,GAFgBA,qBAAA,CAEb,CAAC,CAAC,cAAAA,qBAAA,uBAFWA,qBAAA,CAETd,KAAK,CAACe,SAAS,CAAC;QACxD,IAAI,CAACJ,MAAM,EAAE;UACX;UACA,IAAIQ,UAAU,GAAGpB,WAAW;UAC5B,IAAIqB,WAAW;UACf,OAAOD,UAAU,IAAI,EAAAE,WAAA,GAAAF,UAAU,cAAAE,WAAA,gBAAAA,WAAA,GAAVA,WAAA,CAAYpB,GAAG,cAAAoB,WAAA,gBAAAA,WAAA,GAAfA,WAAA,CAAiBjB,KAAK,cAAAiB,WAAA,uBAAtBA,WAAA,CAAwBlB,IAAI,MAAKI,SAAS,EAAE;YAAA,IAAAc,WAAA,EAAAC,eAAA;YAC/DF,WAAW,IAAAE,eAAA,GAAGH,UAAU,CAAClB,GAAG,cAAAqB,eAAA,gBAAAA,eAAA,GAAdA,eAAA,CAAgBlB,KAAK,cAAAkB,eAAA,uBAArBA,eAAA,CAAuBN,MAAM;YAC3CG,UAAU,GAAGvB,YAAY,CAAC2B,GAAG,CAAC,CAAC;UACjC;UACAZ,MAAM,GAAG,GAAG,CAACa,MAAM,EACjB;UACA,qBAAuBJ,WAAW,GAAGA,WAAW,GAAG,CAAC,GAAG,CACzD,CAAC;QACH;MACF;MAEA,OAAOV,KAAK,CAACe,eAAe,EAC1B;MACC1B,WAAW,EACZ,IAAI,CAACyB,MAAM,CAACjC,KAAK,CAAC,IACjBiB,QAAQ,GAAG,IAAI,GAAGG,MAAM,GAAG,EAAE,CAChC,CAAC;IACH,CAAC;IACDxB,MAAM,CAAC,YAAYI,KAAK,6BAA6B,EAAEkB,GAAG,CAAC;EAC7D;AACF,CAAC,EAAE;EACDiB,gBAAgB,EAAE,IAAI;EACtBC,IAAI,EAAE;IACJC,OAAO,EAAE,MAAM;IACfC,IAAI,EAAE;MACJC,WAAW,EAAE,iEAAiE;MAC9EC,GAAG,EAAE;IACP,CAAC;IACDC,MAAM,EAAE,CACN;MACEC,oBAAoB,EAAE,KAAK;MAC3BC,UAAU,EAAE;QACVzC,YAAY,EAAE;UACZ0C,IAAI,EAAE,OAAO;UACbC,KAAK,EAAE;YACLD,IAAI,EAAE;UACR;QACF,CAAC;QACD3C,cAAc,EAAE;UACd2C,IAAI,EAAE;QACR,CAAC;QACD5C,KAAK,EAAE;UACL4C,IAAI,EAAE;QACR;MACF,CAAC;MACDA,IAAI,EAAE;IACR,CAAC,CACF;IACDA,IAAI,EAAE;EACR;AACF,CAAC,CAAC;AAAAE,MAAA,CAAAvD,OAAA,GAAAA,OAAA,CAAAF,OAAA","ignoreList":[]}